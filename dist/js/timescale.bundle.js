(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{13:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var d3_selection__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),d3_drag__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(12),d3_scale__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),d3_transition__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10),d3_hierarchy__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9),d3_fetch__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(11),d3_ease__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6);const timescale=function(){function searchTree(t,e,_){if(console.log("searching tree",t,"for",e,"to match",_),t.data[e]==_)return t;if(null!=t.children){let n=null;for(let a=0;null==n&&a<t.children.length;a++)n=searchTree(t.children[a],e,_);return n}return null}d3_selection__WEBPACK_IMPORTED_MODULE_0__.h.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})};let width=window.innerWidth-4;const height=130,data={oid:0,nam:"Geologic Time",children:[]},interval_hash={0:data};let currentInterval,root;return{init:function(t){Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#"+t).attr("class","timescale");const e=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#"+t).append("svg").attr("width",width).attr("height",height+20).append("g"),_=e.append("g").attr("id","tickBar").attr("transform",`translate(0,${height-5})`),n=Object(d3_hierarchy__WEBPACK_IMPORTED_MODULE_4__.b)().size([width,height]).padding(0);Object(d3_fetch__WEBPACK_IMPORTED_MODULE_5__.a)("jsons/intervals.json").then(function(t){t.records.forEach(t=>{t.children=[],t.pid=t.pid||0,t.abr=t.abr||t.nam.charAt(0),t.mid=parseInt((t.eag+t.lag)/2),t.total=t.eag-t.lag,interval_hash[t.oid]=t,interval_hash[t.pid].children.push(t)}),root=Object(d3_hierarchy__WEBPACK_IMPORTED_MODULE_4__.a)(data).sum(t=>0===t.children.length?t.total+.117:0),n(root),e.append("g").attr("id","rectGroup").selectAll("rect").data(root.descendants()).enter().append("rect").attr("x",function(t){return t.x0}).attr("y",function(t){return t.y0}).attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).attr("fill",function(t){return t.data.col||"#000"}).attr("id",function(t){return"t"+t.data.oid}).style("opacity",.83).on("click",function(t){timescale.goTo(t)});const a=_.selectAll("rect").data(root.descendants()).enter().append("g").attr("class",function(t){return"tickGroup s"+t.data.lvl}).attr("transform",function(t){return`translate(${t.x0}, 0)`});a.append("line").attr("x1",0).attr("y1",6).attr("x2",0).attr("y2",12).style("stroke-width","0.05em"),a.append("text").attr("x",0).attr("y",20).style("text-anchor",function(t){return.0117!==t.data.eag?"middle":"end"}).style("font-size","0.65em").style("fill","#000").text(function(t){return t.data.eag});const r=_.append("g").data([{x0:width,y0:0}]).attr("class","tickGroup s1 s2 s3 s4 s5").attr("transform",`translate(${width}, 0)`);r.append("line").attr("x1",0).attr("y1",6).attr("x2",0).attr("y2",12).style("stroke-width","0.05em"),r.append("text").attr("x",0).attr("y",20).attr("id","now").style("fill","white").style("text-anchor","end").style("font-size","0.65em").style("fill","#777").text("0");const i=e.append("g").attr("id","textGroup");i.selectAll("fullName").data(root.descendants()).enter().append("text").text(function(t){return t.data.nam}).attr("x",1).attr("y",function(t){return t.y0+15}).attr("width",function(){return this.getComputedTextLength()}).attr("height",function(t){return t.y1-t.y0}).attr("class",function(t){return"fullName level"+t.data.lvl}).attr("id",function(t){return"l"+t.data.oid}).attr("x",function(t){return timescale.labelX(t)}).on("click",function(t){timescale.goTo(t)}),i.selectAll("abbrevs").data(root.descendants()).enter().append("text").attr("x",1).attr("y",function(t){return t.y0+15}).attr("width",30).attr("height",function(t){return t.y1-t.y0}).text(function(t){return t.data.abr}).attr("class",function(t){return"abbr level"+t.data.lvl}).attr("id",function(t){return"a"+t.data.oid}).attr("x",function(t){return timescale.labelAbbrX(t)}).on("click",function(t){timescale.goTo(t)}),timescale.goTo(root),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(".abbr.levelundefined").remove(),timescale.goTo("Phanerozoïcum"),timescale.currentInterval=searchTree(root,"nam","Phanerozoïcum")}),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(window).on("resize",timescale.resize)},labelAbbrX:function(t){const e=parseFloat(Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#t"+t.data.oid).attr("width")),_=parseFloat(Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#t"+t.data.oid).attr("x"));let n=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#a"+t.data.oid).node().getComputedTextLength();return e-8<n&&Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#a"+t.data.oid).style("display","none"),_+(e-n)/2},labelX:function(t){const e=t.x1-t.x0,_=t.x0;let n;try{n=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#l"+t.data.oid).node().getComputedTextLength()}catch(t){n=25}return e-10<n?Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#l"+t.data.oid).style("display","none"):Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#a"+t.data.oid).style("display","none"),_+(e-n)/2},goTo:function(d){if("string"==typeof d)d=searchTree(root,"nam",d);else if(d.children&&d.children.length<1){const t=t.data.parent}console.log("going to",d),timescale.currentInterval=d,Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".fullName").style("display","block"),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".abbr").style("display","block");const depth="undefined"!==d.depth?parseInt(d.depth)+1:1;Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".scale").style("display","none"),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".tickGroup").style("display","none"),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".s"+depth).style("display","block");const x=Object(d3_scale__WEBPACK_IMPORTED_MODULE_2__.a)().range([5,width]).domain([d.x0,d.x1]),t=Object(d3_transition__WEBPACK_IMPORTED_MODULE_3__.a)().duration(300).ease(d3_ease__WEBPACK_IMPORTED_MODULE_6__.b);if(Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("rect").transition(t).attr("x",function(t){return x(t.x0)}).attr("width",function(t){return x(t.x1)-x(t.x0)}),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".tickGroup").transition(t).attr("transform",function(t){if(Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(this).selectAll("text").style("text-anchor","middle"),5===x(t.x0)?Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(this).select("text").style("text-anchor","start"):t.x0===width&&Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(this).select("text").style("text-anchor","end"),"number"==typeof x(t.x0))return`translate(${x(t.x0)}, 0)`}),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".fullName").transition(t).attr("x",function(t){const e=x(t.x1)-x(t.x0),_=x(t.x0);let n;try{n=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#l"+t.data.oid).node().getComputedTextLength()}catch(t){n=25}return e-8<n?Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#l"+t.data.oid).style("display","none"):Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#a"+t.data.oid).style("display","none"),_+(e-n)/2}).attr("height",function(t){return t.y1-t.y0}),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".abbr").transition(t).attr("x",function(t){const e=x(t.x1)-x(t.x0),_=x(t.x0);let n=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#a"+t.data.oid).node().getComputedTextLength();return e-8<n&&Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#a"+t.data.oid).style("display","none"),_+(e-n)/2}).attr("height",function(t){return t.y1-t.y0}).on("end",function(){Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".fullName").style("fill","#333"),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".abbr").style("fill","#333")}),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)("#l"+d.data.oid).transition(t).attr("x",width/2),null!==d.parent){const depth=d.depth;let loc="d.parent";for(let i=0;i<depth;i++){const parent=eval(loc).data.nam;Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".abbr").filter(t=>t.data.nam===parent).transition(t).attr("x",width/2),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".fullName").filter(t=>t.data.nam===parent).transition(t).attr("x",width/2),loc+=".parent"}Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".abbr").filter(t=>t.data.nam===parent).transition(t).attr("x",width/2),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".fullName").filter(t=>t.data.nam===parent).transition(t).attr("x",width/2)}},highlight:function(t){if(Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("rect").style("stroke","#fff"),t.cxi){t.cxi;Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("rect#t"+t.cxi).style("stroke","#000").moveToFront(),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("#l"+t.cxi).moveToFront()}else if("string"==typeof t){let e=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("rect").filter(function(e){return e.nam===t}).attr("id");e=e.replace("t","")}else{let e=Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(t).attr("id");e=e.replace("p","")}Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(`rect#t${id}`).style("stroke","#000").moveToFront(),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("#l"+id).moveToFront(),Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)(".abbr").moveToFront()},unhighlight:function(){Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.g)("rect").style("stroke","#fff")},resize:function(){width=window.innerWidth-4,Object(d3_selection__WEBPACK_IMPORTED_MODULE_0__.f)(".timescale svg").style("width",width),setTimeout(()=>{timescale.goTo(timescale.currentInterval.data.nam)},600)},interval_hash:interval_hash,currentInterval:currentInterval}}();__webpack_exports__.default=timescale}}]);