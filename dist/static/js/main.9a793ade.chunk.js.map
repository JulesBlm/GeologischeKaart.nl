{"version":3,"sources":["ControlPanel.js","App.js","serviceWorker.js","index.js","timescale.js"],"names":["defaultContainer","_ref","children","react_default","a","createElement","className","ControlPanel","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","index","handleClick","bind","assertThisInitialized","timescale","init","amount","setState","prevState","place","plaatsen","goToViewport","mapstyle","changeMapStyle","goTo","period","_this2","Container","containerComponent","currentPlace","name","dangerouslySetInnerHTML","__html","description","id","onClick","disabled","length","PureComponent","App","mapStyle","viewState","longitude","latitude","zoom","maxZoom","pitch","bearing","_goToViewport","objectSpread","transitionDuration","transitionInterpolator","FlyToInterpolator","_changeMapStyle","_onWebGLInitialized","gl","_onMapLoad","map","_map","deck","_deck","addLayer","MapboxLayer","_onHover","_onViewStateChange","_renderTooltip","x","_ref2","y","object","hoveredObject","_this$state","style","top","left","zIndex","key","properties","KRTCODE","info","_ref3","_this$props$data","data","geomap","GeoJsonLayer","opacity","stroked","filled","fp64","getFillColor","f","color","split","getLineColor","pickable","onHover","_this$state2","_this$props$controlle","controller","Fragment","dist_esm","width","ref","layers","_renderLayers","onViewStateChange","onWebGLInitialized","esm","getMap","onLoad","reuseMaps","preventStyleDiffing","mapboxApiAccessToken","visibilityConstraints","minZoom","minPitch","maxPitch","onViewportChange","ControlPanel_ControlPanel","Component","Boolean","window","location","hostname","match","ReactDOM","render","App_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","d3_selection__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","d3_scale__WEBPACK_IMPORTED_MODULE_1__","d3_transition__WEBPACK_IMPORTED_MODULE_2__","d3_hierarchy__WEBPACK_IMPORTED_MODULE_3__","d3_fetch__WEBPACK_IMPORTED_MODULE_4__","d3_ease__WEBPACK_IMPORTED_MODULE_5__","searchTree","node","property","result","i","selection","prototype","moveToFront","each","parentNode","appendChild","innerWidth","height","oid","nam","interval_hash","0","currentInterval","root","div","select","attr","time","append","scale","concat","partitionFunc","partition","size","padding","json","records","forEach","pid","abr","charAt","mid","parseInt","eag","lag","total","push","hierarchy","sum","d","selectAll","descendants","enter","x0","y0","x1","y1","col","on","hash","lvl","text","now","textGroup","getComputedTextLength","labelX","labelAbbrX","remove","resize","rectWidth","parseFloat","rectX","labelWidth","err","parent","depth","scaleLinear","range","domain","t","transition","duration","ease","easeLinear","abbrevWidth","loc","_loop","eval","filter","highlight","cxi","e","replace","unhighlight"],"mappings":"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","file":"static/js/main.9a793ade.chunk.js","sourcesContent":["import React, {PureComponent} from 'react';\nimport timescale from './timescale';\n\nimport plaatsen from './plaatsen.json';\n\nconst defaultContainer =  ({children}) => <div className=\"control-panel\">{children}</div>;\n\nexport default class ControlPanel extends PureComponent {\n  \n    constructor(props) {\n        super(props);    \n        this.handleClick = this.handleClick.bind(this);\n    }\n\n    state = { \n        index: 0\n    }\n\n    componentDidMount() {\n        timescale.init(\"timescale\");\n    }\n\n    handleClick(amount) {\n        const { index } = this.state;\n        if (index => 0 && index < plaatsen.length - 1 ) {\n            this.setState((prevState) => {\n                return { index: prevState.index+amount };\n            });\n         \n            const place = plaatsen[this.state.index + amount];\n            this.props.goToViewport(place);\n            if (place.mapstyle) { this.props.changeMapStyle(place.mapstyle); }; ////\"mapstyle\": \"mapbox://styles/mapbox/satellite-streets-v9\"\n            timescale.goTo(place.period);\n        }\n    }\n  \n    render() {\n        const Container = this.props.containerComponent || defaultContainer;\n        const currentPlace = plaatsen[this.state.index];\n        // console.log(\"index\", this.state.index);\n\n        return (\n            <Container>\n                <div className=\"text\">\n                    <h2>{currentPlace.name}</h2>\n                    <h3>{currentPlace.period}</h3>\n                    <p dangerouslySetInnerHTML={ {__html:currentPlace.description} } />\n                </div>\n                <div id=\"button-bar\">\n                    <button\n                        onClick={() => this.handleClick(-1)}\n                        className=\"control\"\n                        disabled={this.state.index === 0}>\n                        Vorige\n                    </button>\n                    <button \n                        onClick={() => this.handleClick(1)} \n                        className=\"control\"\n                        disabled={this.state.index === plaatsen.length}>\n                        Volgende\n                    </button>\n                </div>\n                <div id=\"timescale\"></div>\n            </Container>\n        );\n  }\n}","/*\n1. Add correct lat lon's\n2. Add more text\n3. Bundle mapbox CSS\n4. Add meta description\n\nPotential\n0. Images and (temperature) charts\n1. Async descriptions\n2. Performance improvements\n3. Bring water to front\n*/\nimport React, {Component} from 'react';\nimport {render} from 'react-dom';\nimport ReactMapGL, {FlyToInterpolator, NavigationControl} from 'react-map-gl'; //, \nimport DeckGL, {GeoJsonLayer} from 'deck.gl';\nimport {MapboxLayer} from \"@deck.gl/mapbox\";\n\nimport ControlPanel from './ControlPanel';\n\nimport geomap from './geologielimburg.json';\nimport key from './key.json'\n\nconst MAPBOX_TOKEN = 'pk.eyJ1Ijoid29tcG8iLCJhIjoiY2pwd3NweXAwMHgzejQzbW11cG9ucWY4ZiJ9.S9-VQRVZ_DWo-b2DhXWPYA'; // Set your mapbox token here\n\nexport default class App extends Component {\n\n  constructor(props) {\n    super(props);\n    this._onHover = this._onHover.bind(this);\n    this._onViewStateChange = this._onViewStateChange.bind(this);\n    this._renderTooltip = this._renderTooltip.bind(this);\n    this._goToViewport = this._goToViewport.bind(this);\n  }\n\n  state = {\n    mapStyle: 'mapbox://styles/wompo/cjq4cbqju9k5a2sqmz8lwcepk',\n    viewState: {\n      longitude: 5.850884,\n      latitude: 50.864828,\n      zoom: 10,\n      maxZoom: 16,\n      pitch: 15,\n      bearing: 0\n    }\n  };\n\n  _onHover({x, y, object}) {\n    this.setState({x, y, hoveredObject: object});\n  }\n\n  _renderTooltip() {\n    const {x, y, hoveredObject} = this.state;\n    return (\n      hoveredObject && (\n        <div className=\"tooltip\" style={{top: y, left: x, zIndex: 1000}}>\n          <div>\n            <b>Formatie</b>\n          </div>\n          <div>\n            <div dangerouslySetInnerHTML={ {__html: key[hoveredObject.properties.KRTCODE].info} } />\n          </div>\n        </div>\n      )\n    );\n  }\n\n  _goToViewport = ({latitude, longitude, zoom}) => {\n    // console.log(\"going to viewport\");\n    this.setState({\n      viewState: {\n        ...this.state.viewState,\n        transitionDuration: 1000,\n        transitionInterpolator: new FlyToInterpolator(),\n        longitude,\n        latitude,\n        zoom,\n        pitch: 10\n      }\n    });\n  };\n\n  _onViewStateChange({viewState}) {\n    this.setState({viewState});\n  }\n\n  _changeMapStyle = (mapStyle) => {\n    this.setState({mapStyle});\n  }\n\n  // DeckGL and mapbox will both draw into this WebGL context\n  _onWebGLInitialized = (gl) => {\n    this.setState({gl});\n  }\n\n  // Add deck layer to mapbox\n  _onMapLoad = () => {\n    const map = this._map;\n    const deck = this._deck;\n    map.addLayer(new MapboxLayer({id: 'geologicalmap', deck}), 'waterway-label');\n  }\n\n  _renderLayers() {\n    const {data = geomap} = this.props;\n    return [\n        new GeoJsonLayer({\n          id: 'geologicalmap',\n          data,\n          opacity: 0.4,\n          stroked: true,\n          filled: true,\n          fp64: true,\n          getFillColor: f => key[f.properties.KRTCODE].color.split(','),\n          getLineColor: [255, 255, 255, 59],\n          pickable: true,\n          onHover: this._onHover\n        })\n      ];\n  }\n\n  render() {\n    const {gl, viewState, mapStyle} = this.state;\n    const {controller = true} = this.props;\n\n    return (\n      <>\n        <DeckGL\n          width={\"70%\"}\n          ref={ref => {this._deck = ref && ref.deck;}}\n          layers={this._renderLayers()}\n          viewState={viewState}\n          onViewStateChange={this._onViewStateChange}\n          controller={controller}\n          onWebGLInitialized={this._onWebGLInitialized}\n        >\n          {gl && (\n            <ReactMapGL\n              ref={ref => { this._map = ref && ref.getMap(); }} // save a reference to the mapboxgl.Map instance\n              gl={gl}\n              onLoad={this._onMapLoad}\n              reuseMaps\n              mapStyle={mapStyle}\n              preventStyleDiffing={true}\n              mapboxApiAccessToken={MAPBOX_TOKEN}\n              visibilityConstraints={{ minZoom: 10, maxZoom: 14, minPitch: 0, maxPitch: 60 }}\n            >\n              <NavigationControl onViewportChange={this._onViewStateChange} />\n            </ReactMapGL>\n          )}\n          {this._renderTooltip()}\n        </DeckGL>\n        <ControlPanel\n          containerComponent={this.props.containerComponent}\n          goToViewport={this._goToViewport}\n          changeMapStyle={this._changeMapStyle}\n        />\n      </>\n    );\n  }\n}\n\nexport function renderToDom(container) {\n  render(<App/>, container);\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// 1. Fix drag\n// 2. Fix ticks\n\nimport { selection, select, selectAll } from \"d3-selection\"; //event\n// import { drag } from \"d3-drag\"\nimport { scaleLinear } from \"d3-scale\";\nimport { transition } from \"d3-transition\";\nimport { partition, hierarchy } from \"d3-hierarchy\";\nimport { json } from \"d3-fetch\";\nimport { easeLinear } from \"d3-ease\";\n\nconst timescale = (function() {\n  // Via http://stackoverflow.com/questions/14167863/how-can-i-bring-a-circle-to-the-front-with-d3\n  // Necessary for highlighting time intervals properly\n  selection.prototype.moveToFront = function() {\n    return this.each(function(){\n      this.parentNode.appendChild(this);\n    });\n  };\n\n  // Via https://stackoverflow.com/questions/9133500/how-to-find-a-node-in-a-tree-with-javascript\n  function searchTree(node, property, match){\n    if (property === \"nam\" || \"oid\" || \"mid\" || \"lag\" || \"\") {\n      if (node.data[property] === match){\n        return node;\n      } else if (node.children != null){\n          let result = null;\n          for (let i=0; result == null && i < node.children.length; i++) {\n            result = searchTree(node.children[i], property, match);\n          }\n          return result;\n      }\n      return null;\n    } else {\n      console.warn(\"Property can't be used to search\")\n    }\n  }\n\n  let width = 0.3 * window.innerWidth - 4;\n  const height = 130;\n\n  // Initialize data\n  const data = { oid: 0, nam: \"Geologische Tijdschaal\", children: [] };\n  const interval_hash = { 0: data };\n  let currentInterval;\n  let root;\n\n  return {\n\n    \"init\": function(div) {\n\n      // let newX = 0.01;\n      // let transformStart;\n      // let dragStart;\n\n      // const dragFunc = drag()\n      //   .subject(function() { \n      //     // const t = select(\".timescale g\");\n      //     return {x: newX, y: 0};\n      //   })\n      //   .on(\"start\", function() {\n      //     dragStart = event.pageX;\n      //     // console.log(\"timescale > g\", select(\".timescale\").select(\"g\"))\n      //     // console.log(\"attr transform\", select(\".timescale\").select(\"g\").attr(\"transform\")) // Only show a scale transform no translate\n      //     transformStart = getTransformation(select(\".timescale\").select(\"g\").attr(\"transform\"));\n      //     // console.log({transformStart})\n      //     event.sourceEvent.stopPropagation();\n      //   })\n      //   .on(\"drag\", function() {\n      //   \tconst currentDrag = event.pageX;\n\n      //    \tnewX = (dragStart - currentDrag);\n\n      //     select(\".timescale\").select(\"g\")\n      //       .attr(\"transform\", function() {\n      //         return `translate(${[ parseInt(transformStart[0] + -newX), 0 ]}) scale(${parseInt(select(\".timescale\").style(\"width\"))/width})`;\n      //       });\n      //   });\n      \n      // Add class timescale to whatever div was supplied\n     select(\"#\" + div).attr(\"class\", \"timescale\");\n\n      // !!!Move into draw!\n      // Create the SVG for the chart\n      const time = select(\"#\" + div).append(\"svg\")\n          .attr(\"width\", width)\n          .attr(\"height\", height + 20)\n          .append(\"g\");\n\n      // Move whole tick SVG group down 125px\n      const scale = time.append(\"g\")\n        .attr(\"id\", \"tickBar\")\n        .attr(\"transform\", `translate(0,${height-5})`);\n\n      // Create a new d3 partition layout\n      const partitionFunc = partition()\n        .size([width, height])\n        .padding(0);\n\n      // Load the time scale data\n      json(\"intervals.json\").then(function(result) {\n\n        // Construct hierarchy variable 'data' by oid's from paleoJSON\n        result.records.forEach(i => {\n          i.children = [];\n          i.pid = i.pid || 0; // Check if i is not a highest level period\n          i.abr = i.abr || i.nam.charAt(0);\n          i.mid = parseInt((i.eag + i.lag) / 2); //length of period\n          i.total = i.eag - i.lag;\n          interval_hash[i.oid] = i;\n          interval_hash[i.pid].children.push(i);\n        })\n        \n        root = hierarchy(data)\n          .sum(d => (d.children.length === 0) ? d.total + 0.117 : 0 ); //? add time for Holocene\n\n        partitionFunc(root);\n\n        const rectGroup = time.append(\"g\")\n          .attr(\"id\", \"rectGroup\");\n\n        // Create the rectangles\n        rectGroup.selectAll(\"rect\")\n            .data( root.descendants() )\n          .enter().append(\"rect\")\n            .attr(\"x\", function(d) { return d.x0; })\n            .attr(\"y\", function(d) { return d.y0; })\n            .attr(\"width\", function(d) { return d.x1 - d.x0; })\n            .attr(\"height\", function(d) { return d.y1 - d.y0; })\n            .attr(\"fill\", function(d) { return d.data.col || \"#000\"; })\n            .attr(\"id\", function(d) { return \"t\" + d.data.oid; })\n            .style(\"opacity\", 0.83)\n            // .call(dragFunc)\n            .on(\"click\", function(d) { timescale.goTo(d); });\n\n        // Scale bar for the bottom of the graph\n        const scaleBar = scale.selectAll(\"rect\")\n          .data(root.descendants());\n\n        const hash = scaleBar.enter().append(\"g\")\n          .attr(\"class\", function(d) { return \"tickGroup s\" + d.data.lvl})\n          .attr(\"transform\", function(d) { return `translate(${d.x0}, 0)`}); \n\n        hash.append(\"line\")\n          .attr(\"x1\", 0)\n          .attr(\"y1\", 6)\n          .attr(\"x2\", 0)\n          .attr(\"y2\", 12)\n          .style(\"stroke-width\", \"0.05em\");\n\n        hash.append(\"text\")\n          .attr(\"x\", 0)\n          .attr(\"y\", 25)\n          .style(\"text-anchor\", function(d) { return (d.data.eag !== 0.0117) ? \"middle\" : \"end\"; })\n          .style(\"font-size\", \"1.2em\")\n          .style(\"fill\", \"#000\")\n          .text(function(d) { return d.data.eag; });\n\n        // Create a tick for year 0\n        const now = scale.append(\"g\")\n          .data([{x0: width, y0: 0 }])\n          .attr(\"class\", \"tickGroup s1 s2 s3 s4 s5\")\n          .attr(\"transform\",`translate(${width}, 0)`);\n\n        now.append(\"line\")\n          .attr(\"x1\", 0)\n          .attr(\"y1\", 6)\n          .attr(\"x2\", 0)\n          .attr(\"y2\", 12)\n          .style(\"stroke-width\", \"0.05em\");\n\n        now.append(\"text\")\n          .attr(\"x\", 4)\n          .attr(\"y\", 25)\n          .attr(\"id\", \"now\")\n          .style(\"fill\", \"white\")\n          .style(\"text-anchor\", \"end\")\n          .style(\"font-size\", \"1.2em\")\n          .style(\"fill\", \"#777\")\n            .text(\"0\");\n\n        const textGroup = time.append(\"g\")\n          .attr(\"id\", \"textGroup\");\n\n        // Add the full labels\n        textGroup.selectAll(\"fullName\")\n            .data( root.descendants() )\n          .enter().append(\"text\")\n            .text(function(d) { return d.data.nam; })\n            .attr(\"x\", 1)\n            .attr(\"y\", function(d) { return d.y0 + 15;})\n            .attr(\"width\", function() { return this.getComputedTextLength(); })\n            .attr(\"height\", function(d) { return d.y1 - d.y0; })\n            .attr(\"class\", function(d) { return \"fullName level\" + d.data.lvl; })\n            .attr(\"id\", function(d) { return \"l\" + d.data.oid; })\n            .attr(\"x\", function(d) { return timescale.labelX(d); })\n            .on(\"click\", function(d) { timescale.goTo(d); });\n\n        // Add the abbreviations\n        textGroup.selectAll(\"abbrevs\")\n            .data( root.descendants() )\n          .enter().append(\"text\")\n            .attr(\"x\", 1)\n            .attr(\"y\", function(d) { return d.y0 + 15; })\n            .attr(\"width\", 30)\n            .attr(\"height\", function(d) { return d.y1 - d.y0; })\n            .text(function(d) { return d.data.abr; }) //charAt(0)\n            .attr(\"class\", function(d) { return \"abbr level\" + d.data.lvl; })\n            .attr(\"id\", function(d) { return \"a\" + d.data.oid; })\n            .attr(\"x\", function(d) { return timescale.labelAbbrX(d); })\n            .on(\"click\", function(d) { timescale.goTo(d); });\n\n        // Position the labels for the first time\n        timescale.goTo(root);\n\n        // Remove the Geologic time abbreviation\n        select(\".abbr.levelundefined\").remove();\n        \n        // Open to Phanerozoic \n        timescale.goTo(\"Phanerozoïcum\");\n        timescale.currentInterval = searchTree(root, \"nam\", \"Phanerozoïcum\");\n      }); // End PaleoDB json callback\n      //attach window resize listener to the window\n      select(window).on(\"resize\", timescale.resize);\n    },\n\n    // Calculates x-position for label abbreviations\n    \"labelAbbrX\": function(d) {\n      const rectWidth = parseFloat(select(\"#t\" + d.data.oid).attr(\"width\")),\n          rectX = parseFloat(select(\"#t\" + d.data.oid).attr(\"x\"));\n\n      let labelWidth = select(\"#a\" + d.data.oid).node().getComputedTextLength();\n\n      if (rectWidth - 8 < labelWidth) {\n       select(\"#a\" + d.data.oid).style(\"display\", \"none\");\n      }\n\n      return rectX + (rectWidth - labelWidth) / 2;\n    },\n    \n    \"labelX\": function(d) {\n      const rectWidth = d.x1 - d.x0;\n      const rectX = d.x0;\n\n      let labelWidth;\n      try {\n        labelWidth = select(\"#l\" + d.data.oid).node().getComputedTextLength();\n      } catch(err) {\n        labelWidth = 25;\n      }\n\n      // Hide full names if they are too small for their rectangles\n      if (rectWidth - 10 < labelWidth) {\n       select(\"#l\" + d.data.oid).style(\"display\", \"none\");\n      } else {\n       select(\"#a\" + d.data.oid).style(\"display\", \"none\");\n      }\n\n      return rectX + (rectWidth - labelWidth) / 2;\n    },\n\n    // Zooms the graph to a given time interval\n    // Accepts a data point or a named interval\n    \"goTo\": function(d) {\n      // console.log(\"goto\", d);\n      if (typeof d == \"string\") {\n        d = searchTree(root, \"nam\", d)\n      } else if (d.children) {\n          if (d.children.length < 1) {\n            d = d.data.parent;\n          }\n      }\n\n      // Stores the currently focused time interval for state restoration purposes\n      timescale.currentInterval = d;\n\n     selectAll(\".fullName\")\n      .style(\"display\", \"block\");\n\n     selectAll(\".abbr\")\n        .style(\"display\", \"block\");\n      \n      // Adjust the bottom scale\n      const depth = (d.depth !== 'undefined') ? parseInt(d.depth) + 1 : 1;\n     selectAll(\".scale\").style(\"display\", \"none\");\n     selectAll(\".tickGroup\").style(\"display\", \"none\");\n     selectAll(\".s\" + depth).style(\"display\", \"block\");\n\n      const x = scaleLinear()\n        .range([5, width])\n        .domain([d.x0, d.x1]); \n\n      // Define transition for concurrent animation\n      const t = transition()\n        .duration(300)\n        .ease(easeLinear);\n\n      // Transition the rectangles\n     selectAll(\"rect\").transition(t)\n        .attr(\"x\", function(d) { return x(d.x0); })\n        .attr(\"width\", function(d) { return x(d.x1) - x(d.x0); })    \n\n      // Transition tick groups\n     selectAll(\".tickGroup\").transition(t)\n        .attr(\"transform\", function(d) {\n         select(this).selectAll(\"text\").style(\"text-anchor\", \"middle\");\n          if (x(d.x0) === 5) {\n           select(this).select(\"text\")\n              .style(\"text-anchor\", \"start\");\n          } else if (d.x0 === width) {\n           select(this).select(\"text\")\n              .style(\"text-anchor\", \"end\");\n          }\n          if (typeof x(d.x0) === 'number') {return `translate(${x(d.x0)}, 0)`}\n        });\n        \n      // Move the full names, to keep animation concurrent labelX has to be calculated inside to goTo function\n     selectAll(\".fullName\").transition(t)\n        .attr(\"x\", function(d) { \n            const rectWidth = x(d.x1) - x(d.x0),\n                  rectX = x(d.x0);\n\n            let labelWidth;\n            try {\n              labelWidth = select(\"#l\" + d.data.oid).node().getComputedTextLength(); //this?\n            } catch(err) {\n              labelWidth = 25;\n            }\n\n            if (rectWidth - 8 < labelWidth) {\n             select(\"#l\" + d.data.oid).style(\"display\", \"none\");\n           } else {\n             select(\"#a\" + d.data.oid).style(\"display\", \"none\");\n           }\n\n            return rectX + (rectWidth - labelWidth) / 2;\n        })\n        .attr(\"height\", function(d) { return d.y1 - d.y0; })\n\n      //Move the abbreviations\n      selectAll(\".abbr\").transition(t)\n        .attr(\"x\", function(d) {\n          const rectWidth = x(d.x1) - x(d.x0);\n          const rectX = x(d.x0);\n\n          let abbrevWidth = select(\"#a\" + d.data.oid).node().getComputedTextLength();\n          \n          if (rectWidth - 8 < abbrevWidth) {\n           select(\"#a\" + d.data.oid).style(\"display\", \"none\");\n          }\n          \n          return rectX + (rectWidth - abbrevWidth) / 2;\n        })\n        .attr(\"height\", function(d) { return d.y1 - d.y0; })\n        .on(\"end\", function() { \n         selectAll(\".fullName\").style(\"fill\", \"#333\");\n         selectAll(\".abbr\").style(\"fill\", \"#333\");\n        });\n\n      // Center whichever interval was clicked\n      select(\"#l\" + d.data.oid).transition(t)\n        .attr(\"x\", width/2);\n\n      // Position all the parent labels in the middle of the scale\n      if (d.parent !== null) {\n        const depth = d.depth;\n        let loc = \"d.parent\";\n        for (let i=0; i < depth; i++) {\n          const parent = eval(loc).data.nam;\n          selectAll('.abbr').filter(d => d.data.nam === parent ).transition(t)\n            .attr(\"x\", width/2);\n          selectAll('.fullName').filter(d => d.data.nam === parent ).transition(t)\n            .attr(\"x\", width/2);\n          loc += \".parent\";\n        }\n        selectAll('.abbr').filter(d => d.data.nam === d.parent).transition(t)\n          .attr(\"x\", width/2);\n        selectAll('.fullName').filter(d => d.data.nam === d.parent).transition(t)\n          .attr(\"x\", width/2);\n      }        \n    },\n\n    // Highlight a given time interval\n    \"highlight\": function(d) {\n\n     selectAll(\"rect\").style(\"stroke\", \"#fff\");\n     let id;\n      if (d.cxi) {\n        id = d.cxi;\n       selectAll(\"rect#t\" + d.cxi).style(\"stroke\", \"#000\").moveToFront();\n       selectAll(\"#l\" + d.cxi).moveToFront();\n      } else if (typeof d == \"string\") {\n        id = selectAll('rect').filter(function(e) {\n          return e.nam === d;\n        }).attr(\"id\");\n        id = id.replace(\"t\", \"\");\n      } else {\n        id = select(d).attr(\"id\");\n        id = id.replace(\"p\", \"\");\n      }\n\n     selectAll(`rect#t${id}`).style(\"stroke\", \"#000\").moveToFront();\n     selectAll(\"#l\" + id).moveToFront();\n     selectAll(\".abbr\").moveToFront();\n    },\n\n    // Unhighlight a time interval by resetting the stroke of all rectangles\n    \"unhighlight\": function() {\n     selectAll(\"rect\").style(\"stroke\", \"#fff\");\n    },\n\n    \"resize\": function() {\n      width = window.innerWidth - 4;\n      \n      select(\".timescale svg\")\n        .style(\"width\", width)\n\n      // setTimeout(() => {\n      //   timescale.goTo(timescale.currentInterval.data.nam)\n      // }, 600);\n    },\n\n    /* Interval hash can be exposed publically so that the time scale data can be used \n       for other things, such as maps */\n    // https://github.com/d3/d3-hierarchy/issues/58 \n    \"interval_hash\": interval_hash, \n\n    // Method for getting the currently zoomed-to interval - useful for preserving states\n    \"currentInterval\": currentInterval\n  }\n})();\n\nexport default timescale;"],"sourceRoot":""}